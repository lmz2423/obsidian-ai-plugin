/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __markAsModule = (target) => __defProp(target, "__esModule", { value: true });
var __export = (target, all) => {
  __markAsModule(target);
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __reExport = (target, module2, desc) => {
  if (module2 && typeof module2 === "object" || typeof module2 === "function") {
    for (let key of __getOwnPropNames(module2))
      if (!__hasOwnProp.call(target, key) && key !== "default")
        __defProp(target, key, { get: () => module2[key], enumerable: !(desc = __getOwnPropDesc(module2, key)) || desc.enumerable });
  }
  return target;
};
var __toModule = (module2) => {
  return __reExport(__markAsModule(__defProp(module2 != null ? __create(__getProtoOf(module2)) : {}, "default", module2 && module2.__esModule && "default" in module2 ? { get: () => module2.default, enumerable: true } : { value: module2, enumerable: true })), module2);
};
var __async = (__this, __arguments, generator) => {
  return new Promise((resolve, reject) => {
    var fulfilled = (value) => {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    };
    var rejected = (value) => {
      try {
        step(generator.throw(value));
      } catch (e) {
        reject(e);
      }
    };
    var step = (x) => x.done ? resolve(x.value) : Promise.resolve(x.value).then(fulfilled, rejected);
    step((generator = generator.apply(__this, __arguments)).next());
  });
};

// src/main.ts
__export(exports, {
  default: () => AIPlugin
});
var import_obsidian3 = __toModule(require("obsidian"));

// src/AIPromptView.ts
var import_obsidian = __toModule(require("obsidian"));
var AIPromptView = class {
  constructor(app, plugin, editor) {
    this.app = app;
    this.plugin = plugin;
    this.editor = editor;
    this.isVisible = false;
    this.container = document.createElement("div");
    this.container.addClass("ai-prompt-container");
    this.input = document.createElement("input");
    this.input.addClass("ai-prompt-input");
    this.input.placeholder = "\u6309\u4F4F\u7A7A\u683C\u542F\u52A8 AI...";
    this.container.appendChild(this.input);
    this.dropdown = document.createElement("div");
    this.dropdown.addClass("ai-prompt-dropdown");
    this.container.appendChild(this.dropdown);
    this.initializeDropdown();
    this.clickOutsideHandler = this.handleClickOutside.bind(this);
  }
  initializeDropdown() {
    const commands = [
      { id: "summarize", name: "\u6DFB\u52A0\u6458\u8981", icon: "list" },
      { id: "todo", name: "\u6DFB\u52A0\u5F85\u529E\u4E8B\u9879", icon: "checkbox" },
      { id: "table", name: "\u6DFB\u52A0\u8868\u683C", icon: "table" },
      { id: "flowchart", name: "\u6DFB\u52A0\u6D41\u7A0B\u56FE", icon: "flow" }
    ];
    commands.forEach((cmd) => {
      const item = document.createElement("div");
      item.addClass("ai-prompt-item");
      const icon = document.createElement("span");
      icon.addClass("ai-prompt-icon");
      icon.addClass(cmd.icon);
      const text = document.createElement("span");
      text.textContent = cmd.name;
      item.appendChild(icon);
      item.appendChild(text);
      item.addEventListener("click", () => __async(this, null, function* () {
        const prompt = this.input.value;
        const result = yield this.executeCommand(cmd.id, prompt);
        if (result) {
          this.editor.replaceSelection(result);
        }
        this.hide();
      }));
      this.dropdown.appendChild(item);
    });
  }
  executeCommand(commandId, prompt) {
    return __async(this, null, function* () {
      try {
        switch (commandId) {
          case "summarize":
            return yield this.plugin.generateSummary(prompt);
          case "todo":
            return yield this.plugin.generateTodoList(prompt);
          case "table":
            return yield this.plugin.generateTable(prompt);
          case "flowchart":
            return yield this.plugin.generateFlowchart(prompt);
          default:
            return "";
        }
      } catch (error) {
        new import_obsidian.Notice("\u6267\u884C\u547D\u4EE4\u5931\u8D25: " + error.message);
        return "";
      }
    });
  }
  isInputFocused() {
    return document.activeElement === this.input;
  }
  show(position) {
    if (!this.isVisible) {
      const viewportWidth = window.innerWidth;
      const viewportHeight = window.innerHeight;
      let left = position.left;
      if (left + 300 > viewportWidth) {
        left = viewportWidth - 310;
      }
      let top = position.top;
      const estimatedHeight = 200;
      if (top + estimatedHeight > viewportHeight) {
        top = position.top - estimatedHeight - 10;
      }
      this.container.style.left = `${Math.max(10, left)}px`;
      this.container.style.top = `${Math.max(10, top)}px`;
      document.body.appendChild(this.container);
      setTimeout(() => {
        this.input.focus();
      }, 50);
      document.addEventListener("mousedown", this.clickOutsideHandler);
      this.isVisible = true;
    }
  }
  hide() {
    if (this.isVisible) {
      this.container.remove();
      document.removeEventListener("mousedown", this.clickOutsideHandler);
      this.isVisible = false;
      this.input.value = "";
    }
  }
  handleClickOutside(e) {
    if (!this.container.contains(e.target)) {
      this.hide();
    }
  }
};

// src/settings.ts
var import_obsidian2 = __toModule(require("obsidian"));
var AI_PROVIDERS = [
  {
    id: "openai",
    name: "OpenAI",
    baseUrl: "https://api.openai.com/v1/chat/completions",
    models: [
      { id: "gpt-4", name: "GPT-4" },
      { id: "gpt-4-turbo", name: "GPT-4 Turbo" },
      { id: "gpt-3.5-turbo", name: "GPT-3.5 Turbo" }
    ]
  },
  {
    id: "claude",
    name: "Claude",
    baseUrl: "https://api.anthropic.com/v1/messages",
    models: [
      { id: "claude-3-opus", name: "Claude 3 Opus" },
      { id: "claude-3-sonnet", name: "Claude 3 Sonnet" },
      { id: "claude-2.1", name: "Claude 2.1" }
    ]
  },
  {
    id: "kimi",
    name: "Kimi",
    baseUrl: "https://api.moonshot.cn/v1/chat/completions",
    models: [
      { id: "moonshot-v1-8k", name: "Moonshot V1 8K" },
      { id: "moonshot-v1-32k", name: "Moonshot V1 32K" },
      { id: "moonshot-v1-128k", name: "Moonshot V1 128K" }
    ]
  },
  {
    id: "chatglm",
    name: "ChatGLM",
    baseUrl: "https://open.bigmodel.cn/api/paas/v4/chat/completions",
    models: [
      { id: "glm-4", name: "GLM-4" },
      { id: "glm-3-turbo", name: "GLM-3 Turbo" }
    ]
  },
  {
    id: "deepseek",
    name: "DeepSeek",
    baseUrl: "https://api.deepseek.com/v1/chat/completions",
    models: [
      { id: "deepseek-chat", name: "DeepSeek Chat" },
      { id: "deepseek-coder", name: "DeepSeek Coder" }
    ]
  },
  {
    id: "azure",
    name: "Azure OpenAI",
    baseUrl: "",
    models: [
      { id: "gpt-4", name: "GPT-4" },
      { id: "gpt-35-turbo", name: "GPT-3.5 Turbo" }
    ]
  },
  {
    id: "moonshot",
    name: "Moonshot",
    baseUrl: "https://api.moonshot.cn/v1/chat/completions",
    models: [
      { id: "moonshot-v1-8k", name: "Moonshot V1 8K" },
      { id: "moonshot-v1-32k", name: "Moonshot V1 32K" },
      { id: "moonshot-v1-128k", name: "Moonshot V1 128K" }
    ]
  }
];
var DEFAULT_SETTINGS = {
  provider: "openai",
  model: "gpt-3.5-turbo",
  apiKey: "",
  apiEndpoint: "https://api.openai.com/v1/chat/completions"
};
var AISettingTab = class extends import_obsidian2.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    new import_obsidian2.Setting(containerEl).setName("AI Provider").setDesc("\u9009\u62E9 AI \u670D\u52A1\u63D0\u4F9B\u5546").addDropdown((dropdown) => {
      AI_PROVIDERS.forEach((provider) => {
        dropdown.addOption(provider.id, provider.name);
      });
      dropdown.setValue(this.plugin.settings.provider).onChange((value) => __async(this, null, function* () {
        this.plugin.settings.provider = value;
        const provider = AI_PROVIDERS.find((p) => p.id === value);
        if (provider) {
          if (provider.models.length > 0) {
            this.plugin.settings.model = provider.models[0].id;
          }
        }
        yield this.plugin.saveSettings();
        this.display();
      }));
    });
    const currentProvider = AI_PROVIDERS.find((p) => p.id === this.plugin.settings.provider);
    if (currentProvider) {
      new import_obsidian2.Setting(containerEl).setName("AI Model").setDesc("\u9009\u62E9 AI \u6A21\u578B").addDropdown((dropdown) => {
        currentProvider.models.forEach((model) => {
          dropdown.addOption(model.id, model.name);
        });
        dropdown.setValue(this.plugin.settings.model).onChange((value) => __async(this, null, function* () {
          this.plugin.settings.model = value;
          yield this.plugin.saveSettings();
        }));
      });
    }
    new import_obsidian2.Setting(containerEl).setName("API Key").setDesc("\u8F93\u5165 API Key").addText((text) => text.setPlaceholder("Enter your API key").setValue(this.plugin.settings.apiKey).onChange((value) => __async(this, null, function* () {
      this.plugin.settings.apiKey = value;
      yield this.plugin.saveSettings();
    })));
    new import_obsidian2.Setting(containerEl).setName("API Endpoint").setDesc("\u8F93\u5165 API \u7AEF\u70B9\u5730\u5740\uFF08\u53EF\u9009\uFF0C\u7559\u7A7A\u4F7F\u7528\u9ED8\u8BA4\u503C\uFF09").addText((text) => {
      const provider = AI_PROVIDERS.find((p) => p.id === this.plugin.settings.provider);
      text.setPlaceholder((provider == null ? void 0 : provider.baseUrl) || "Enter API endpoint").setValue(this.plugin.settings.apiEndpoint).onChange((value) => __async(this, null, function* () {
        const provider2 = AI_PROVIDERS.find((p) => p.id === this.plugin.settings.provider);
        this.plugin.settings.apiEndpoint = value || (provider2 == null ? void 0 : provider2.baseUrl) || "";
        yield this.plugin.saveSettings();
      }));
    });
    new import_obsidian2.Setting(containerEl).setName("\u91CD\u7F6E API \u7AEF\u70B9").setDesc("\u6062\u590D\u9ED8\u8BA4 API \u7AEF\u70B9").addButton((button) => button.setButtonText("\u91CD\u7F6E").onClick(() => __async(this, null, function* () {
      const provider = AI_PROVIDERS.find((p) => p.id === this.plugin.settings.provider);
      if (provider) {
        this.plugin.settings.apiEndpoint = provider.baseUrl;
        yield this.plugin.saveSettings();
        this.display();
      }
    })));
  }
};

// src/main.ts
var AIPlugin = class extends import_obsidian3.Plugin {
  constructor() {
    super(...arguments);
    this.aiPromptView = null;
    this.placeholderMarker = null;
    this.placeholderText = "\u6309\u4F4F\u7A7A\u683C\u542F\u52A8 AI...";
  }
  onload() {
    return __async(this, null, function* () {
      yield this.loadSettings();
      this.addSettingTab(new AISettingTab(this.app, this));
      this.registerEvent(this.app.workspace.on("active-leaf-change", () => {
        this.updatePlaceholder();
      }));
      this.registerEvent(this.app.workspace.on("editor-change", () => {
        this.updatePlaceholder();
      }));
      let spaceKeyPressed = false;
      this.registerDomEvent(document, "keydown", (evt) => {
        if (evt.key === " " && !evt.repeat && !evt.isComposing && !spaceKeyPressed) {
          const activeView = this.app.workspace.getActiveViewOfType(import_obsidian3.MarkdownView);
          if (activeView) {
            const editor = activeView.editor;
            const cursor = editor.getCursor();
            const line = editor.getLine(cursor.line);
            if (!line.trim()) {
              evt.preventDefault();
              spaceKeyPressed = true;
              this.showAIPrompt(editor, cursor);
            }
          }
        }
        if (evt.key === "Enter") {
          setTimeout(() => {
            this.updatePlaceholder();
          }, 0);
        }
      });
      this.registerDomEvent(document, "keyup", (evt) => {
        if (evt.key === " ") {
          spaceKeyPressed = false;
          if (this.aiPromptView && !this.aiPromptView.isInputFocused()) {
            this.aiPromptView.hide();
          }
        }
      });
    });
  }
  loadSettings() {
    return __async(this, null, function* () {
      this.settings = Object.assign({}, DEFAULT_SETTINGS, yield this.loadData());
    });
  }
  saveSettings() {
    return __async(this, null, function* () {
      yield this.saveData(this.settings);
    });
  }
  updatePlaceholder() {
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian3.MarkdownView);
    if (!activeView)
      return;
    const editor = activeView.editor;
    const cursor = editor.getCursor();
    this.clearAllPlaceholders();
    const totalLines = editor.lineCount();
    for (let i = 0; i < totalLines; i++) {
      const line = editor.getLine(i);
      if (!line.trim()) {
        if (i === cursor.line) {
          this.showPlaceholderAtLine(i, activeView);
        }
      }
    }
  }
  clearAllPlaceholders() {
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian3.MarkdownView);
    if (!activeView)
      return;
    const existingPlaceholders = activeView.contentEl.querySelectorAll(".ai-prompt-placeholder");
    existingPlaceholders.forEach((el) => el.remove());
    if (this.placeholderMarker) {
      this.placeholderMarker.clear();
      this.placeholderMarker = null;
    }
  }
  showPlaceholderAtLine(lineNumber, view) {
    const editorEl = view.contentEl.querySelector(".cm-editor");
    if (!editorEl)
      return;
    const lineEl = editorEl.querySelector(`.cm-line:nth-child(${lineNumber + 1})`);
    if (!lineEl)
      return;
    if (!lineEl.querySelector(".ai-prompt-placeholder")) {
      const placeholder = this.createPlaceholderElement();
      lineEl.appendChild(placeholder);
      this.placeholderMarker = {
        clear: () => placeholder.remove()
      };
    }
  }
  createPlaceholderElement() {
    const placeholder = document.createElement("span");
    placeholder.addClass("ai-prompt-placeholder");
    placeholder.setText(this.placeholderText);
    placeholder.style.fontStyle = "italic";
    placeholder.style.color = "var(--text-faint)";
    return placeholder;
  }
  showAIPrompt(editor, cursor) {
    const view = this.app.workspace.getActiveViewOfType(import_obsidian3.MarkdownView);
    if (!view)
      return;
    const editorEl = view.contentEl.querySelector(".cm-editor");
    if (!editorEl)
      return;
    const lineEl = editorEl.querySelector(`.cm-line:nth-child(${cursor.line + 1})`);
    if (!lineEl)
      return;
    const editorRect = editorEl.getBoundingClientRect();
    const lineRect = lineEl.getBoundingClientRect();
    if (!this.aiPromptView) {
      this.aiPromptView = new AIPromptView(this.app, this, editor);
    }
    const absoluteLeft = lineRect.left;
    const absoluteTop = lineRect.top;
    this.aiPromptView.show({
      left: absoluteLeft,
      top: absoluteTop + lineRect.height
    });
  }
  onunload() {
    if (this.placeholderMarker) {
      this.placeholderMarker.clear();
    }
    if (this.aiPromptView) {
      this.aiPromptView.hide();
    }
  }
  callAIAPI(prompt) {
    return __async(this, null, function* () {
      try {
        const provider = AI_PROVIDERS.find((p) => p.id === this.settings.provider);
        if (!provider) {
          throw new Error("\u672A\u627E\u5230 AI \u63D0\u4F9B\u5546");
        }
        const apiEndpoint = this.settings.apiEndpoint || provider.baseUrl;
        if (!apiEndpoint) {
          throw new Error("\u672A\u8BBE\u7F6E API \u7AEF\u70B9");
        }
        const headers = {
          "Content-Type": "application/json"
        };
        switch (this.settings.provider) {
          case "openai":
          case "deepseek":
            headers["Authorization"] = `Bearer ${this.settings.apiKey}`;
            break;
          case "claude":
            headers["x-api-key"] = this.settings.apiKey;
            headers["anthropic-version"] = "2023-06-01";
            break;
          case "azure":
            headers["api-key"] = this.settings.apiKey;
            break;
          case "chatglm":
            headers["Authorization"] = this.settings.apiKey;
            break;
          default:
            headers["Authorization"] = `Bearer ${this.settings.apiKey}`;
        }
        let requestBody;
        switch (this.settings.provider) {
          case "claude":
            requestBody = {
              model: this.settings.model,
              messages: [{ role: "user", content: prompt }],
              max_tokens: 1e3
            };
            break;
          default:
            requestBody = {
              model: this.settings.model,
              messages: [{ role: "user", content: prompt }]
            };
        }
        const response = yield fetch(apiEndpoint, {
          method: "POST",
          headers,
          body: JSON.stringify(requestBody)
        });
        if (!response.ok) {
          throw new Error(`API request failed: ${response.statusText}`);
        }
        const data = yield response.json();
        switch (this.settings.provider) {
          case "claude":
            return data.content[0].text;
          default:
            return data.choices[0].message.content;
        }
      } catch (error) {
        new import_obsidian3.Notice("AI API \u8C03\u7528\u5931\u8D25: " + error.message);
        return "";
      }
    });
  }
  generateSummary(prompt) {
    return __async(this, null, function* () {
      return yield this.callAIAPI(`\u751F\u6210\u6458\u8981\uFF1A${prompt}`);
    });
  }
  generateTodoList(prompt) {
    return __async(this, null, function* () {
      return yield this.callAIAPI(`\u751F\u6210\u5F85\u529E\u4E8B\u9879\uFF1A${prompt}`);
    });
  }
  generateTable(prompt) {
    return __async(this, null, function* () {
      return yield this.callAIAPI(`\u751F\u6210\u8868\u683C\uFF1A${prompt}`);
    });
  }
  generateFlowchart(prompt) {
    return __async(this, null, function* () {
      return yield this.callAIAPI(`\u751F\u6210\u6D41\u7A0B\u56FE\uFF1A${prompt}`);
    });
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL0FJUHJvbXB0Vmlldy50cyIsICJzcmMvc2V0dGluZ3MudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7IEFwcCwgUGx1Z2luLCBFZGl0b3IsIE1lbnUsIE5vdGljZSwgTWFya2Rvd25WaWV3LCBFZGl0b3JQb3NpdGlvbiB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IEFJUHJvbXB0VmlldyB9IGZyb20gJy4vQUlQcm9tcHRWaWV3JztcbmltcG9ydCB7IEFJU2V0dGluZ1RhYiwgQUlQbHVnaW5TZXR0aW5ncywgREVGQVVMVF9TRVRUSU5HUywgQUlfUFJPVklERVJTLCBBSVByb3ZpZGVyIH0gZnJvbSAnLi9zZXR0aW5ncyc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEFJUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcbiAgICBzZXR0aW5nczogQUlQbHVnaW5TZXR0aW5ncztcbiAgICBwcml2YXRlIGFpUHJvbXB0VmlldzogQUlQcm9tcHRWaWV3IHwgbnVsbCA9IG51bGw7XG4gICAgcHJpdmF0ZSBwbGFjZWhvbGRlck1hcmtlcjogYW55ID0gbnVsbDtcbiAgICBwcml2YXRlIHBsYWNlaG9sZGVyVGV4dDogc3RyaW5nID0gXCJcdTYzMDlcdTRGNEZcdTdBN0FcdTY4M0NcdTU0MkZcdTUyQTggQUkuLi5cIjtcblxuICAgIGFzeW5jIG9ubG9hZCgpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcbiAgICAgICAgXG4gICAgICAgIHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgQUlTZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSk7XG4gICAgICAgIFxuICAgICAgICAvLyBcdTc2RDFcdTU0MkNcdTdGMTZcdThGOTFcdTU2NjhcdTUzRDhcdTUzMTZcbiAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50KFxuICAgICAgICAgICAgdGhpcy5hcHAud29ya3NwYWNlLm9uKCdhY3RpdmUtbGVhZi1jaGFuZ2UnLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVQbGFjZWhvbGRlcigpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcblxuICAgICAgICAvLyBcdTc2RDFcdTU0MkNcdTdGMTZcdThGOTFcdTU2NjhcdTUxODVcdTVCQjlcdTUzRDhcdTUzMTZcdTU0OENcdTUxNDlcdTY4MDdcdTc5RkJcdTUyQThcbiAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50KFxuICAgICAgICAgICAgdGhpcy5hcHAud29ya3NwYWNlLm9uKCdlZGl0b3ItY2hhbmdlJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlUGxhY2Vob2xkZXIoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG5cbiAgICAgICAgbGV0IHNwYWNlS2V5UHJlc3NlZCA9IGZhbHNlO1xuXG4gICAgICAgIC8vIFx1NzZEMVx1NTQyQ1x1OTUyRVx1NzZEOFx1NEU4Qlx1NEVGNlxuICAgICAgICB0aGlzLnJlZ2lzdGVyRG9tRXZlbnQoZG9jdW1lbnQsICdrZXlkb3duJywgKGV2dDogS2V5Ym9hcmRFdmVudCkgPT4ge1xuICAgICAgICAgICAgLy8gXHU1OTA0XHU3NDA2XHU3QTdBXHU2ODNDXHU5NTJFXG4gICAgICAgICAgICBpZiAoZXZ0LmtleSA9PT0gJyAnICYmICFldnQucmVwZWF0ICYmICFldnQuaXNDb21wb3NpbmcgJiYgIXNwYWNlS2V5UHJlc3NlZCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGFjdGl2ZVZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuICAgICAgICAgICAgICAgIGlmIChhY3RpdmVWaWV3KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGVkaXRvciA9IGFjdGl2ZVZpZXcuZWRpdG9yO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXJzb3IgPSBlZGl0b3IuZ2V0Q3Vyc29yKCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGxpbmUgPSBlZGl0b3IuZ2V0TGluZShjdXJzb3IubGluZSk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBcdTUzRUFcdTU3MjhcdTdBN0FcdTg4NENcdTRFMEFcdTY2M0VcdTc5M0FcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFsaW5lLnRyaW0oKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzcGFjZUtleVByZXNzZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93QUlQcm9tcHQoZWRpdG9yLCBjdXJzb3IpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBcdTU5MDRcdTc0MDYgRW50ZXIgXHU5NTJFXG4gICAgICAgICAgICBpZiAoZXZ0LmtleSA9PT0gJ0VudGVyJykge1xuICAgICAgICAgICAgICAgIC8vIFx1NUVGNlx1OEZERlx1NjI2N1x1ODg0Q1x1NEVFNVx1Nzg2RVx1NEZERFx1NjVCMFx1ODg0Q1x1NURGMlx1NTIxQlx1NUVGQVxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVBsYWNlaG9sZGVyKCk7XG4gICAgICAgICAgICAgICAgfSwgMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIFx1N0E3QVx1NjgzQ1x1OTUyRVx1OTFDQVx1NjUzRVx1NEU4Qlx1NEVGNlxuICAgICAgICB0aGlzLnJlZ2lzdGVyRG9tRXZlbnQoZG9jdW1lbnQsICdrZXl1cCcsIChldnQ6IEtleWJvYXJkRXZlbnQpID0+IHtcbiAgICAgICAgICAgIGlmIChldnQua2V5ID09PSAnICcpIHtcbiAgICAgICAgICAgICAgICBzcGFjZUtleVByZXNzZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5haVByb21wdFZpZXcgJiYgIXRoaXMuYWlQcm9tcHRWaWV3LmlzSW5wdXRGb2N1c2VkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5haVByb21wdFZpZXcuaGlkZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgYXN5bmMgbG9hZFNldHRpbmdzKCkge1xuICAgICAgICB0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcbiAgICB9XG5cbiAgICBhc3luYyBzYXZlU2V0dGluZ3MoKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSB1cGRhdGVQbGFjZWhvbGRlcigpIHtcbiAgICAgICAgY29uc3QgYWN0aXZlVmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG4gICAgICAgIGlmICghYWN0aXZlVmlldykgcmV0dXJuO1xuXG4gICAgICAgIGNvbnN0IGVkaXRvciA9IGFjdGl2ZVZpZXcuZWRpdG9yO1xuICAgICAgICBjb25zdCBjdXJzb3IgPSBlZGl0b3IuZ2V0Q3Vyc29yKCk7XG4gICAgICAgIFxuICAgICAgICAvLyBcdTUxNDhcdTZFMDVcdTk2NjRcdTYyNDBcdTY3MDlcdTUzNjBcdTRGNERcdTdCMjZcbiAgICAgICAgdGhpcy5jbGVhckFsbFBsYWNlaG9sZGVycygpO1xuXG4gICAgICAgIC8vIFx1ODNCN1x1NTNENlx1NjI0MFx1NjcwOVx1N0E3QVx1ODg0Q1xuICAgICAgICBjb25zdCB0b3RhbExpbmVzID0gZWRpdG9yLmxpbmVDb3VudCgpO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRvdGFsTGluZXM7IGkrKykge1xuICAgICAgICAgICAgY29uc3QgbGluZSA9IGVkaXRvci5nZXRMaW5lKGkpO1xuICAgICAgICAgICAgaWYgKCFsaW5lLnRyaW0oKSkge1xuICAgICAgICAgICAgICAgIC8vIFx1NTNFQVx1NTcyOFx1NUY1M1x1NTI0RFx1NTE0OVx1NjgwN1x1NjI0MFx1NTcyOFx1NzY4NFx1N0E3QVx1ODg0Q1x1NjYzRVx1NzkzQVx1NTM2MFx1NEY0RFx1N0IyNlxuICAgICAgICAgICAgICAgIGlmIChpID09PSBjdXJzb3IubGluZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dQbGFjZWhvbGRlckF0TGluZShpLCBhY3RpdmVWaWV3KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGNsZWFyQWxsUGxhY2Vob2xkZXJzKCkge1xuICAgICAgICBjb25zdCBhY3RpdmVWaWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcbiAgICAgICAgaWYgKCFhY3RpdmVWaWV3KSByZXR1cm47XG5cbiAgICAgICAgLy8gXHU3OUZCXHU5NjY0XHU2MjQwXHU2NzA5XHU3M0IwXHU2NzA5XHU3Njg0XHU1MzYwXHU0RjREXHU3QjI2XG4gICAgICAgIGNvbnN0IGV4aXN0aW5nUGxhY2Vob2xkZXJzID0gYWN0aXZlVmlldy5jb250ZW50RWwucXVlcnlTZWxlY3RvckFsbCgnLmFpLXByb21wdC1wbGFjZWhvbGRlcicpO1xuICAgICAgICBleGlzdGluZ1BsYWNlaG9sZGVycy5mb3JFYWNoKGVsID0+IGVsLnJlbW92ZSgpKTtcblxuICAgICAgICAvLyBcdTZFMDVcdTk2NjRcdTY4MDdcdThCQjBcbiAgICAgICAgaWYgKHRoaXMucGxhY2Vob2xkZXJNYXJrZXIpIHtcbiAgICAgICAgICAgIHRoaXMucGxhY2Vob2xkZXJNYXJrZXIuY2xlYXIoKTtcbiAgICAgICAgICAgIHRoaXMucGxhY2Vob2xkZXJNYXJrZXIgPSBudWxsO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzaG93UGxhY2Vob2xkZXJBdExpbmUobGluZU51bWJlcjogbnVtYmVyLCB2aWV3OiBNYXJrZG93blZpZXcpIHtcbiAgICAgICAgY29uc3QgZWRpdG9yRWwgPSB2aWV3LmNvbnRlbnRFbC5xdWVyeVNlbGVjdG9yKCcuY20tZWRpdG9yJyk7XG4gICAgICAgIGlmICghZWRpdG9yRWwpIHJldHVybjtcblxuICAgICAgICBjb25zdCBsaW5lRWwgPSBlZGl0b3JFbC5xdWVyeVNlbGVjdG9yKGAuY20tbGluZTpudGgtY2hpbGQoJHtsaW5lTnVtYmVyICsgMX0pYCk7XG4gICAgICAgIGlmICghbGluZUVsKSByZXR1cm47XG5cbiAgICAgICAgLy8gXHU3ODZFXHU0RkREXHU4QkU1XHU4ODRDXHU4RkQ4XHU2Q0ExXHU2NzA5XHU1MzYwXHU0RjREXHU3QjI2XG4gICAgICAgIGlmICghbGluZUVsLnF1ZXJ5U2VsZWN0b3IoJy5haS1wcm9tcHQtcGxhY2Vob2xkZXInKSkge1xuICAgICAgICAgICAgY29uc3QgcGxhY2Vob2xkZXIgPSB0aGlzLmNyZWF0ZVBsYWNlaG9sZGVyRWxlbWVudCgpO1xuICAgICAgICAgICAgbGluZUVsLmFwcGVuZENoaWxkKHBsYWNlaG9sZGVyKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gXHU0RkREXHU1QjU4XHU2ODA3XHU4QkIwXHU0RUU1XHU0RkJGXHU1NDBFXHU3RUVEXHU2RTA1XHU5NjY0XG4gICAgICAgICAgICB0aGlzLnBsYWNlaG9sZGVyTWFya2VyID0ge1xuICAgICAgICAgICAgICAgIGNsZWFyOiAoKSA9PiBwbGFjZWhvbGRlci5yZW1vdmUoKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgY3JlYXRlUGxhY2Vob2xkZXJFbGVtZW50KCk6IEhUTUxFbGVtZW50IHtcbiAgICAgICAgY29uc3QgcGxhY2Vob2xkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgICAgIHBsYWNlaG9sZGVyLmFkZENsYXNzKCdhaS1wcm9tcHQtcGxhY2Vob2xkZXInKTtcbiAgICAgICAgcGxhY2Vob2xkZXIuc2V0VGV4dCh0aGlzLnBsYWNlaG9sZGVyVGV4dCk7XG4gICAgICAgIC8vIFx1NzZGNFx1NjNBNVx1NTcyOFx1NTE0M1x1N0QyMFx1NEUwQVx1OEJCRVx1N0Y2RVx1NjgzN1x1NUYwRlx1RkYwQ1x1Nzg2RVx1NEZERFx1NjgzN1x1NUYwRlx1NzUxRlx1NjU0OFxuICAgICAgICBwbGFjZWhvbGRlci5zdHlsZS5mb250U3R5bGUgPSAnaXRhbGljJztcbiAgICAgICAgcGxhY2Vob2xkZXIuc3R5bGUuY29sb3IgPSAndmFyKC0tdGV4dC1mYWludCknO1xuICAgICAgICByZXR1cm4gcGxhY2Vob2xkZXI7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzaG93QUlQcm9tcHQoZWRpdG9yOiBFZGl0b3IsIGN1cnNvcjogRWRpdG9yUG9zaXRpb24pIHtcbiAgICAgICAgY29uc3QgdmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG4gICAgICAgIGlmICghdmlldykgcmV0dXJuO1xuXG4gICAgICAgIC8vIFx1ODNCN1x1NTNENlx1N0YxNlx1OEY5MVx1NTY2OFx1NUJCOVx1NTY2OFx1NTQ4Q1x1NTE0OVx1NjgwN1x1NEY0RFx1N0Y2RVxuICAgICAgICBjb25zdCBlZGl0b3JFbCA9IHZpZXcuY29udGVudEVsLnF1ZXJ5U2VsZWN0b3IoJy5jbS1lZGl0b3InKTtcbiAgICAgICAgaWYgKCFlZGl0b3JFbCkgcmV0dXJuO1xuXG4gICAgICAgIGNvbnN0IGxpbmVFbCA9IGVkaXRvckVsLnF1ZXJ5U2VsZWN0b3IoYC5jbS1saW5lOm50aC1jaGlsZCgke2N1cnNvci5saW5lICsgMX0pYCk7XG4gICAgICAgIGlmICghbGluZUVsKSByZXR1cm47XG5cbiAgICAgICAgLy8gXHU4M0I3XHU1M0Q2XHU4ODRDXHU3Njg0XHU0RjREXHU3RjZFXG4gICAgICAgIGNvbnN0IGVkaXRvclJlY3QgPSBlZGl0b3JFbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgY29uc3QgbGluZVJlY3QgPSBsaW5lRWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cbiAgICAgICAgaWYgKCF0aGlzLmFpUHJvbXB0Vmlldykge1xuICAgICAgICAgICAgdGhpcy5haVByb21wdFZpZXcgPSBuZXcgQUlQcm9tcHRWaWV3KHRoaXMuYXBwLCB0aGlzLCBlZGl0b3IpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gXHU4QkExXHU3Qjk3XHU3RUREXHU1QkY5XHU0RjREXHU3RjZFXG4gICAgICAgIGNvbnN0IGFic29sdXRlTGVmdCA9IGxpbmVSZWN0LmxlZnQ7XG4gICAgICAgIGNvbnN0IGFic29sdXRlVG9wID0gbGluZVJlY3QudG9wO1xuXG4gICAgICAgIHRoaXMuYWlQcm9tcHRWaWV3LnNob3coe1xuICAgICAgICAgICAgbGVmdDogYWJzb2x1dGVMZWZ0LFxuICAgICAgICAgICAgdG9wOiBhYnNvbHV0ZVRvcCArIGxpbmVSZWN0LmhlaWdodCAvLyBcdTU3MjhcdTUxNDlcdTY4MDdcdTRFMEJcdTY1QjlcdTY2M0VcdTc5M0FcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgb251bmxvYWQoKSB7XG4gICAgICAgIGlmICh0aGlzLnBsYWNlaG9sZGVyTWFya2VyKSB7XG4gICAgICAgICAgICB0aGlzLnBsYWNlaG9sZGVyTWFya2VyLmNsZWFyKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuYWlQcm9tcHRWaWV3KSB7XG4gICAgICAgICAgICB0aGlzLmFpUHJvbXB0Vmlldy5oaWRlKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIGNhbGxBSUFQSShwcm9tcHQ6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBwcm92aWRlciA9IEFJX1BST1ZJREVSUy5maW5kKChwOiBBSVByb3ZpZGVyKSA9PiBwLmlkID09PSB0aGlzLnNldHRpbmdzLnByb3ZpZGVyKTtcbiAgICAgICAgICAgIGlmICghcHJvdmlkZXIpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1x1NjcyQVx1NjI3RVx1NTIzMCBBSSBcdTYzRDBcdTRGOUJcdTU1NDYnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gXHU0RjdGXHU3NTI4XHU4MUVBXHU1QjlBXHU0RTQ5XHU3QUVGXHU3MEI5XHU2MjE2XHU5RUQ4XHU4QkE0XHU3QUVGXHU3MEI5XG4gICAgICAgICAgICBjb25zdCBhcGlFbmRwb2ludCA9IHRoaXMuc2V0dGluZ3MuYXBpRW5kcG9pbnQgfHwgcHJvdmlkZXIuYmFzZVVybDtcbiAgICAgICAgICAgIGlmICghYXBpRW5kcG9pbnQpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1x1NjcyQVx1OEJCRVx1N0Y2RSBBUEkgXHU3QUVGXHU3MEI5Jyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IGhlYWRlcnM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG4gICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLy8gXHU2ODM5XHU2MzZFXHU0RTBEXHU1NDBDXHU2M0QwXHU0RjlCXHU1NTQ2XHU4QkJFXHU3RjZFXHU0RTBEXHU1NDBDXHU3Njg0XHU4QkE0XHU4QkMxXHU1OTM0XG4gICAgICAgICAgICBzd2l0Y2ggKHRoaXMuc2V0dGluZ3MucHJvdmlkZXIpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdvcGVuYWknOlxuICAgICAgICAgICAgICAgIGNhc2UgJ2RlZXBzZWVrJzpcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyc1snQXV0aG9yaXphdGlvbiddID0gYEJlYXJlciAke3RoaXMuc2V0dGluZ3MuYXBpS2V5fWA7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2NsYXVkZSc6XG4gICAgICAgICAgICAgICAgICAgIGhlYWRlcnNbJ3gtYXBpLWtleSddID0gdGhpcy5zZXR0aW5ncy5hcGlLZXk7XG4gICAgICAgICAgICAgICAgICAgIGhlYWRlcnNbJ2FudGhyb3BpYy12ZXJzaW9uJ10gPSAnMjAyMy0wNi0wMSc7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2F6dXJlJzpcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyc1snYXBpLWtleSddID0gdGhpcy5zZXR0aW5ncy5hcGlLZXk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2NoYXRnbG0nOlxuICAgICAgICAgICAgICAgICAgICBoZWFkZXJzWydBdXRob3JpemF0aW9uJ10gPSB0aGlzLnNldHRpbmdzLmFwaUtleTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyc1snQXV0aG9yaXphdGlvbiddID0gYEJlYXJlciAke3RoaXMuc2V0dGluZ3MuYXBpS2V5fWA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFx1NjgzOVx1NjM2RVx1NEUwRFx1NTQwQ1x1NjNEMFx1NEY5Qlx1NTU0Nlx1Njc4NFx1OTAyMFx1NEUwRFx1NTQwQ1x1NzY4NFx1OEJGN1x1NkM0Mlx1NEY1M1xuICAgICAgICAgICAgbGV0IHJlcXVlc3RCb2R5OiBhbnk7XG4gICAgICAgICAgICBzd2l0Y2ggKHRoaXMuc2V0dGluZ3MucHJvdmlkZXIpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdjbGF1ZGUnOlxuICAgICAgICAgICAgICAgICAgICByZXF1ZXN0Qm9keSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsOiB0aGlzLnNldHRpbmdzLm1vZGVsLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZXM6IFt7IHJvbGU6ICd1c2VyJywgY29udGVudDogcHJvbXB0IH1dLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWF4X3Rva2VuczogMTAwMFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICByZXF1ZXN0Qm9keSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsOiB0aGlzLnNldHRpbmdzLm1vZGVsLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZXM6IFt7IHJvbGU6ICd1c2VyJywgY29udGVudDogcHJvbXB0IH1dXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYXBpRW5kcG9pbnQsIHtcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICBoZWFkZXJzLFxuICAgICAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHJlcXVlc3RCb2R5KVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEFQSSByZXF1ZXN0IGZhaWxlZDogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBcdTY4MzlcdTYzNkVcdTRFMERcdTU0MENcdTYzRDBcdTRGOUJcdTU1NDZcdTg5RTNcdTY3OTBcdTRFMERcdTU0MENcdTc2ODRcdTU0Q0RcdTVFOTRcdTY4M0NcdTVGMEZcbiAgICAgICAgICAgIHN3aXRjaCAodGhpcy5zZXR0aW5ncy5wcm92aWRlcikge1xuICAgICAgICAgICAgICAgIGNhc2UgJ2NsYXVkZSc6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhLmNvbnRlbnRbMF0udGV4dDtcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0YS5jaG9pY2VzWzBdLm1lc3NhZ2UuY29udGVudDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoJ0FJIEFQSSBcdThDMDNcdTc1MjhcdTU5MzFcdThEMjU6ICcgKyAoZXJyb3IgYXMgRXJyb3IpLm1lc3NhZ2UpO1xuICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gQUkgXHU1MjlGXHU4MEZEXHU2NUI5XHU2Q0Q1XG4gICAgcHVibGljIGFzeW5jIGdlbmVyYXRlU3VtbWFyeShwcm9tcHQ6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmNhbGxBSUFQSShgXHU3NTFGXHU2MjEwXHU2NDU4XHU4OTgxXHVGRjFBJHtwcm9tcHR9YCk7XG4gICAgfVxuXG4gICAgcHVibGljIGFzeW5jIGdlbmVyYXRlVG9kb0xpc3QocHJvbXB0OiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5jYWxsQUlBUEkoYFx1NzUxRlx1NjIxMFx1NUY4NVx1NTI5RVx1NEU4Qlx1OTg3OVx1RkYxQSR7cHJvbXB0fWApO1xuICAgIH1cblxuICAgIHB1YmxpYyBhc3luYyBnZW5lcmF0ZVRhYmxlKHByb21wdDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuY2FsbEFJQVBJKGBcdTc1MUZcdTYyMTBcdTg4NjhcdTY4M0NcdUZGMUEke3Byb21wdH1gKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMgZ2VuZXJhdGVGbG93Y2hhcnQocHJvbXB0OiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5jYWxsQUlBUEkoYFx1NzUxRlx1NjIxMFx1NkQ0MVx1N0EwQlx1NTZGRVx1RkYxQSR7cHJvbXB0fWApO1xuICAgIH1cbn0gXG4iLCAiaW1wb3J0IHsgQXBwLCBFZGl0b3IsIE1hcmtkb3duVmlldywgTm90aWNlIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IEFJUGx1Z2luIGZyb20gJy4vbWFpbic7XG5cbmV4cG9ydCBjbGFzcyBBSVByb21wdFZpZXcge1xuICAgIHByaXZhdGUgY29udGFpbmVyOiBIVE1MRWxlbWVudDtcbiAgICBwcml2YXRlIGlucHV0OiBIVE1MSW5wdXRFbGVtZW50O1xuICAgIHByaXZhdGUgZHJvcGRvd246IEhUTUxFbGVtZW50O1xuICAgIHByaXZhdGUgaXNWaXNpYmxlOiBib29sZWFuID0gZmFsc2U7XG4gICAgcHJpdmF0ZSBjbGlja091dHNpZGVIYW5kbGVyOiAoZTogTW91c2VFdmVudCkgPT4gdm9pZDtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIGFwcDogQXBwLFxuICAgICAgICBwcml2YXRlIHBsdWdpbjogQUlQbHVnaW4sXG4gICAgICAgIHByaXZhdGUgZWRpdG9yOiBFZGl0b3JcbiAgICApIHtcbiAgICAgICAgdGhpcy5jb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgdGhpcy5jb250YWluZXIuYWRkQ2xhc3MoJ2FpLXByb21wdC1jb250YWluZXInKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFx1NTIxQlx1NUVGQVx1OEY5M1x1NTE2NVx1Njg0NlxuICAgICAgICB0aGlzLmlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcbiAgICAgICAgdGhpcy5pbnB1dC5hZGRDbGFzcygnYWktcHJvbXB0LWlucHV0Jyk7XG4gICAgICAgIHRoaXMuaW5wdXQucGxhY2Vob2xkZXIgPSAnXHU2MzA5XHU0RjRGXHU3QTdBXHU2ODNDXHU1NDJGXHU1MkE4IEFJLi4uJztcbiAgICAgICAgdGhpcy5jb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5pbnB1dCk7XG4gICAgICAgIFxuICAgICAgICAvLyBcdTUyMUJcdTVFRkFcdTRFMEJcdTYyQzlcdTk3NjJcdTY3N0ZcbiAgICAgICAgdGhpcy5kcm9wZG93biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICB0aGlzLmRyb3Bkb3duLmFkZENsYXNzKCdhaS1wcm9tcHQtZHJvcGRvd24nKTtcbiAgICAgICAgdGhpcy5jb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5kcm9wZG93bik7XG4gICAgICAgIFxuICAgICAgICAvLyBcdTUyMURcdTU5Q0JcdTUzMTZcdTU0N0RcdTRFRTRcdTUyMTdcdTg4NjhcbiAgICAgICAgdGhpcy5pbml0aWFsaXplRHJvcGRvd24oKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFx1NkNFOFx1NTE4Q1x1NzBCOVx1NTFGQlx1NTkxNlx1OTBFOFx1NEU4Qlx1NEVGNlxuICAgICAgICB0aGlzLmNsaWNrT3V0c2lkZUhhbmRsZXIgPSB0aGlzLmhhbmRsZUNsaWNrT3V0c2lkZS5iaW5kKHRoaXMpO1xuICAgIH1cblxuICAgIHByaXZhdGUgaW5pdGlhbGl6ZURyb3Bkb3duKCkge1xuICAgICAgICBjb25zdCBjb21tYW5kcyA9IFtcbiAgICAgICAgICAgIHsgaWQ6ICdzdW1tYXJpemUnLCBuYW1lOiAnXHU2REZCXHU1MkEwXHU2NDU4XHU4OTgxJywgaWNvbjogJ2xpc3QnIH0sXG4gICAgICAgICAgICB7IGlkOiAndG9kbycsIG5hbWU6ICdcdTZERkJcdTUyQTBcdTVGODVcdTUyOUVcdTRFOEJcdTk4NzknLCBpY29uOiAnY2hlY2tib3gnIH0sXG4gICAgICAgICAgICB7IGlkOiAndGFibGUnLCBuYW1lOiAnXHU2REZCXHU1MkEwXHU4ODY4XHU2ODNDJywgaWNvbjogJ3RhYmxlJyB9LFxuICAgICAgICAgICAgeyBpZDogJ2Zsb3djaGFydCcsIG5hbWU6ICdcdTZERkJcdTUyQTBcdTZENDFcdTdBMEJcdTU2RkUnLCBpY29uOiAnZmxvdycgfVxuICAgICAgICBdO1xuXG4gICAgICAgIGNvbW1hbmRzLmZvckVhY2goY21kID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgIGl0ZW0uYWRkQ2xhc3MoJ2FpLXByb21wdC1pdGVtJyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNvbnN0IGljb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgICAgICAgICBpY29uLmFkZENsYXNzKCdhaS1wcm9tcHQtaWNvbicpO1xuICAgICAgICAgICAgaWNvbi5hZGRDbGFzcyhjbWQuaWNvbik7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNvbnN0IHRleHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgICAgICAgICB0ZXh0LnRleHRDb250ZW50ID0gY21kLm5hbWU7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGl0ZW0uYXBwZW5kQ2hpbGQoaWNvbik7XG4gICAgICAgICAgICBpdGVtLmFwcGVuZENoaWxkKHRleHQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHByb21wdCA9IHRoaXMuaW5wdXQudmFsdWU7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5leGVjdXRlQ29tbWFuZChjbWQuaWQsIHByb21wdCk7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmVkaXRvci5yZXBsYWNlU2VsZWN0aW9uKHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuaGlkZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHRoaXMuZHJvcGRvd24uYXBwZW5kQ2hpbGQoaXRlbSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgZXhlY3V0ZUNvbW1hbmQoY29tbWFuZElkOiBzdHJpbmcsIHByb21wdDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHN3aXRjaCAoY29tbWFuZElkKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnc3VtbWFyaXplJzpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMucGx1Z2luLmdlbmVyYXRlU3VtbWFyeShwcm9tcHQpO1xuICAgICAgICAgICAgICAgIGNhc2UgJ3RvZG8nOlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5wbHVnaW4uZ2VuZXJhdGVUb2RvTGlzdChwcm9tcHQpO1xuICAgICAgICAgICAgICAgIGNhc2UgJ3RhYmxlJzpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMucGx1Z2luLmdlbmVyYXRlVGFibGUocHJvbXB0KTtcbiAgICAgICAgICAgICAgICBjYXNlICdmbG93Y2hhcnQnOlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5wbHVnaW4uZ2VuZXJhdGVGbG93Y2hhcnQocHJvbXB0KTtcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKCdcdTYyNjdcdTg4NENcdTU0N0RcdTRFRTRcdTU5MzFcdThEMjU6ICcgKyBlcnJvci5tZXNzYWdlKTtcbiAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBpc0lucHV0Rm9jdXNlZCgpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgPT09IHRoaXMuaW5wdXQ7XG4gICAgfVxuXG4gICAgc2hvdyhwb3NpdGlvbjogeyBsZWZ0OiBudW1iZXI7IHRvcDogbnVtYmVyIH0pIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzVmlzaWJsZSkge1xuICAgICAgICAgICAgLy8gXHU3ODZFXHU0RkREXHU1QkI5XHU1NjY4XHU1NzI4XHU4OUM2XHU3QTk3XHU1MTg1XG4gICAgICAgICAgICBjb25zdCB2aWV3cG9ydFdpZHRoID0gd2luZG93LmlubmVyV2lkdGg7XG4gICAgICAgICAgICBjb25zdCB2aWV3cG9ydEhlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodDtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gXHU4QzAzXHU2NTc0XHU1REU2XHU0RkE3XHU0RjREXHU3RjZFXHVGRjBDXHU3ODZFXHU0RkREXHU0RTBEXHU4RDg1XHU1MUZBXHU1M0YzXHU4RkI5XHU3NTRDXG4gICAgICAgICAgICBsZXQgbGVmdCA9IHBvc2l0aW9uLmxlZnQ7XG4gICAgICAgICAgICBpZiAobGVmdCArIDMwMCA+IHZpZXdwb3J0V2lkdGgpIHsgLy8gMzAwcHggXHU2NjJGXHU1QkI5XHU1NjY4XHU3Njg0XHU2NzAwXHU1QzBGXHU1QkJEXHU1RUE2XG4gICAgICAgICAgICAgICAgbGVmdCA9IHZpZXdwb3J0V2lkdGggLSAzMTA7IC8vIFx1NzU1OVx1NTFGQVx1NEUwMFx1NEU5Qlx1OEZCOVx1OERERFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBcdThDMDNcdTY1NzRcdTk4NzZcdTkwRThcdTRGNERcdTdGNkVcdUZGMENcdTc4NkVcdTRGRERcdTRFMERcdThEODVcdTUxRkFcdTVFOTVcdTkwRThcdThGQjlcdTc1NENcbiAgICAgICAgICAgIGxldCB0b3AgPSBwb3NpdGlvbi50b3A7XG4gICAgICAgICAgICBjb25zdCBlc3RpbWF0ZWRIZWlnaHQgPSAyMDA7IC8vIFx1NEYzMFx1OEJBMVx1NzY4NFx1NUJCOVx1NTY2OFx1OUFEOFx1NUVBNlxuICAgICAgICAgICAgaWYgKHRvcCArIGVzdGltYXRlZEhlaWdodCA+IHZpZXdwb3J0SGVpZ2h0KSB7XG4gICAgICAgICAgICAgICAgdG9wID0gcG9zaXRpb24udG9wIC0gZXN0aW1hdGVkSGVpZ2h0IC0gMTA7IC8vIFx1RkZGRFx1RkZGRFx1RkZGRFx1NEUwQVx1NjYzRVx1NzkzQVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICB0aGlzLmNvbnRhaW5lci5zdHlsZS5sZWZ0ID0gYCR7TWF0aC5tYXgoMTAsIGxlZnQpfXB4YDtcbiAgICAgICAgICAgIHRoaXMuY29udGFpbmVyLnN0eWxlLnRvcCA9IGAke01hdGgubWF4KDEwLCB0b3ApfXB4YDtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh0aGlzLmNvbnRhaW5lcik7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFx1NkRGQlx1NTJBMFx1NEUwMFx1NEUyQVx1NUMwRlx1NUVGNlx1OEZERlx1Njc2NVx1Nzg2RVx1NEZERFx1NzEyNlx1NzBCOVx1OEJCRVx1N0Y2RVx1NkI2M1x1Nzg2RVxuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5pbnB1dC5mb2N1cygpO1xuICAgICAgICAgICAgfSwgNTApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLmNsaWNrT3V0c2lkZUhhbmRsZXIpO1xuICAgICAgICAgICAgdGhpcy5pc1Zpc2libGUgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaGlkZSgpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNWaXNpYmxlKSB7XG4gICAgICAgICAgICB0aGlzLmNvbnRhaW5lci5yZW1vdmUoKTtcbiAgICAgICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMuY2xpY2tPdXRzaWRlSGFuZGxlcik7XG4gICAgICAgICAgICB0aGlzLmlzVmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5pbnB1dC52YWx1ZSA9ICcnO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBoYW5kbGVDbGlja091dHNpZGUoZTogTW91c2VFdmVudCkge1xuICAgICAgICBpZiAoIXRoaXMuY29udGFpbmVyLmNvbnRhaW5zKGUudGFyZ2V0IGFzIE5vZGUpKSB7XG4gICAgICAgICAgICB0aGlzLmhpZGUoKTtcbiAgICAgICAgfVxuICAgIH1cbn0gXG4iLCAiaW1wb3J0IHsgQXBwLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IEFJUGx1Z2luIGZyb20gJy4vbWFpbic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQUlNb2RlbCB7XG4gICAgaWQ6IHN0cmluZztcbiAgICBuYW1lOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQUlQcm92aWRlciB7XG4gICAgaWQ6IHN0cmluZztcbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgbW9kZWxzOiBBSU1vZGVsW107XG4gICAgYmFzZVVybDogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEFJUGx1Z2luU2V0dGluZ3Mge1xuICAgIHByb3ZpZGVyOiBzdHJpbmc7XG4gICAgbW9kZWw6IHN0cmluZztcbiAgICBhcGlLZXk6IHN0cmluZztcbiAgICBhcGlFbmRwb2ludDogc3RyaW5nO1xufVxuXG5leHBvcnQgY29uc3QgQUlfUFJPVklERVJTOiBBSVByb3ZpZGVyW10gPSBbXG4gICAge1xuICAgICAgICBpZDogJ29wZW5haScsXG4gICAgICAgIG5hbWU6ICdPcGVuQUknLFxuICAgICAgICBiYXNlVXJsOiAnaHR0cHM6Ly9hcGkub3BlbmFpLmNvbS92MS9jaGF0L2NvbXBsZXRpb25zJyxcbiAgICAgICAgbW9kZWxzOiBbXG4gICAgICAgICAgICB7IGlkOiAnZ3B0LTQnLCBuYW1lOiAnR1BULTQnIH0sXG4gICAgICAgICAgICB7IGlkOiAnZ3B0LTQtdHVyYm8nLCBuYW1lOiAnR1BULTQgVHVyYm8nIH0sXG4gICAgICAgICAgICB7IGlkOiAnZ3B0LTMuNS10dXJibycsIG5hbWU6ICdHUFQtMy41IFR1cmJvJyB9XG4gICAgICAgIF1cbiAgICB9LFxuICAgIHtcbiAgICAgICAgaWQ6ICdjbGF1ZGUnLFxuICAgICAgICBuYW1lOiAnQ2xhdWRlJyxcbiAgICAgICAgYmFzZVVybDogJ2h0dHBzOi8vYXBpLmFudGhyb3BpYy5jb20vdjEvbWVzc2FnZXMnLFxuICAgICAgICBtb2RlbHM6IFtcbiAgICAgICAgICAgIHsgaWQ6ICdjbGF1ZGUtMy1vcHVzJywgbmFtZTogJ0NsYXVkZSAzIE9wdXMnIH0sXG4gICAgICAgICAgICB7IGlkOiAnY2xhdWRlLTMtc29ubmV0JywgbmFtZTogJ0NsYXVkZSAzIFNvbm5ldCcgfSxcbiAgICAgICAgICAgIHsgaWQ6ICdjbGF1ZGUtMi4xJywgbmFtZTogJ0NsYXVkZSAyLjEnIH1cbiAgICAgICAgXVxuICAgIH0sXG4gICAge1xuICAgICAgICBpZDogJ2tpbWknLFxuICAgICAgICBuYW1lOiAnS2ltaScsXG4gICAgICAgIGJhc2VVcmw6ICdodHRwczovL2FwaS5tb29uc2hvdC5jbi92MS9jaGF0L2NvbXBsZXRpb25zJyxcbiAgICAgICAgbW9kZWxzOiBbXG4gICAgICAgICAgICB7IGlkOiAnbW9vbnNob3QtdjEtOGsnLCBuYW1lOiAnTW9vbnNob3QgVjEgOEsnIH0sXG4gICAgICAgICAgICB7IGlkOiAnbW9vbnNob3QtdjEtMzJrJywgbmFtZTogJ01vb25zaG90IFYxIDMySycgfSxcbiAgICAgICAgICAgIHsgaWQ6ICdtb29uc2hvdC12MS0xMjhrJywgbmFtZTogJ01vb25zaG90IFYxIDEyOEsnIH1cbiAgICAgICAgXVxuICAgIH0sXG4gICAge1xuICAgICAgICBpZDogJ2NoYXRnbG0nLFxuICAgICAgICBuYW1lOiAnQ2hhdEdMTScsXG4gICAgICAgIGJhc2VVcmw6ICdodHRwczovL29wZW4uYmlnbW9kZWwuY24vYXBpL3BhYXMvdjQvY2hhdC9jb21wbGV0aW9ucycsXG4gICAgICAgIG1vZGVsczogW1xuICAgICAgICAgICAgeyBpZDogJ2dsbS00JywgbmFtZTogJ0dMTS00JyB9LFxuICAgICAgICAgICAgeyBpZDogJ2dsbS0zLXR1cmJvJywgbmFtZTogJ0dMTS0zIFR1cmJvJyB9XG4gICAgICAgIF1cbiAgICB9LFxuICAgIHtcbiAgICAgICAgaWQ6ICdkZWVwc2VlaycsXG4gICAgICAgIG5hbWU6ICdEZWVwU2VlaycsXG4gICAgICAgIGJhc2VVcmw6ICdodHRwczovL2FwaS5kZWVwc2Vlay5jb20vdjEvY2hhdC9jb21wbGV0aW9ucycsXG4gICAgICAgIG1vZGVsczogW1xuICAgICAgICAgICAgeyBpZDogJ2RlZXBzZWVrLWNoYXQnLCBuYW1lOiAnRGVlcFNlZWsgQ2hhdCcgfSxcbiAgICAgICAgICAgIHsgaWQ6ICdkZWVwc2Vlay1jb2RlcicsIG5hbWU6ICdEZWVwU2VlayBDb2RlcicgfVxuICAgICAgICBdXG4gICAgfSxcbiAgICB7XG4gICAgICAgIGlkOiAnYXp1cmUnLFxuICAgICAgICBuYW1lOiAnQXp1cmUgT3BlbkFJJyxcbiAgICAgICAgYmFzZVVybDogJycsIC8vIFx1NzUyOFx1NjIzN1x1OTcwMFx1ODk4MVx1OEY5M1x1NTE2NVx1ODFFQVx1NURGMVx1NzY4NCBBenVyZSBcdTdBRUZcdTcwQjlcbiAgICAgICAgbW9kZWxzOiBbXG4gICAgICAgICAgICB7IGlkOiAnZ3B0LTQnLCBuYW1lOiAnR1BULTQnIH0sXG4gICAgICAgICAgICB7IGlkOiAnZ3B0LTM1LXR1cmJvJywgbmFtZTogJ0dQVC0zLjUgVHVyYm8nIH1cbiAgICAgICAgXVxuICAgIH0sXG4gICAge1xuICAgICAgICBpZDogJ21vb25zaG90JyxcbiAgICAgICAgbmFtZTogJ01vb25zaG90JyxcbiAgICAgICAgYmFzZVVybDogJ2h0dHBzOi8vYXBpLm1vb25zaG90LmNuL3YxL2NoYXQvY29tcGxldGlvbnMnLFxuICAgICAgICBtb2RlbHM6IFtcbiAgICAgICAgICAgIHsgaWQ6ICdtb29uc2hvdC12MS04aycsIG5hbWU6ICdNb29uc2hvdCBWMSA4SycgfSxcbiAgICAgICAgICAgIHsgaWQ6ICdtb29uc2hvdC12MS0zMmsnLCBuYW1lOiAnTW9vbnNob3QgVjEgMzJLJyB9LFxuICAgICAgICAgICAgeyBpZDogJ21vb25zaG90LXYxLTEyOGsnLCBuYW1lOiAnTW9vbnNob3QgVjEgMTI4SycgfVxuICAgICAgICBdXG4gICAgfVxuXTtcblxuZXhwb3J0IGNvbnN0IERFRkFVTFRfU0VUVElOR1M6IEFJUGx1Z2luU2V0dGluZ3MgPSB7XG4gICAgcHJvdmlkZXI6ICdvcGVuYWknLFxuICAgIG1vZGVsOiAnZ3B0LTMuNS10dXJibycsXG4gICAgYXBpS2V5OiAnJyxcbiAgICBhcGlFbmRwb2ludDogJ2h0dHBzOi8vYXBpLm9wZW5haS5jb20vdjEvY2hhdC9jb21wbGV0aW9ucydcbn07XG5cbmV4cG9ydCBjbGFzcyBBSVNldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcbiAgICBwbHVnaW46IEFJUGx1Z2luO1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogQUlQbHVnaW4pIHtcbiAgICAgICAgc3VwZXIoYXBwLCBwbHVnaW4pO1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICB9XG5cbiAgICBkaXNwbGF5KCk6IHZvaWQge1xuICAgICAgICBjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuICAgICAgICBjb250YWluZXJFbC5lbXB0eSgpO1xuXG4gICAgICAgIC8vIEFJIFx1NjNEMFx1NEY5Qlx1NTU0Nlx1OTAwOVx1NjJFOVxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdBSSBQcm92aWRlcicpXG4gICAgICAgICAgICAuc2V0RGVzYygnXHU5MDA5XHU2MkU5IEFJIFx1NjcwRFx1NTJBMVx1NjNEMFx1NEY5Qlx1NTU0NicpXG4gICAgICAgICAgICAuYWRkRHJvcGRvd24oZHJvcGRvd24gPT4ge1xuICAgICAgICAgICAgICAgIEFJX1BST1ZJREVSUy5mb3JFYWNoKHByb3ZpZGVyID0+IHtcbiAgICAgICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKHByb3ZpZGVyLmlkLCBwcm92aWRlci5uYW1lKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm92aWRlcilcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvdmlkZXIgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFx1NjZGNFx1NjVCMFx1OUVEOFx1OEJBNCBBUEkgXHU3QUVGXHU3MEI5XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwcm92aWRlciA9IEFJX1BST1ZJREVSUy5maW5kKHAgPT4gcC5pZCA9PT0gdmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHByb3ZpZGVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gXHU4QkJFXHU3RjZFXHU5RUQ4XHU4QkE0XHU2QTIxXHU1NzhCXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHByb3ZpZGVyLm1vZGVscy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLm1vZGVsID0gcHJvdmlkZXIubW9kZWxzWzBdLmlkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gXHU5MUNEXHU2NUIwXHU2NjNFXHU3OTNBXHU4QkJFXHU3RjZFXHU5ODc1XHU5NzYyXHU0RUU1XHU2NkY0XHU2NUIwXHU2QTIxXHU1NzhCXHU5MDA5XHU5ODc5XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BsYXkoKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAvLyBBSSBcdTZBMjFcdTU3OEJcdTkwMDlcdTYyRTlcbiAgICAgICAgY29uc3QgY3VycmVudFByb3ZpZGVyID0gQUlfUFJPVklERVJTLmZpbmQocCA9PiBwLmlkID09PSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm92aWRlcik7XG4gICAgICAgIGlmIChjdXJyZW50UHJvdmlkZXIpIHtcbiAgICAgICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgICAgIC5zZXROYW1lKCdBSSBNb2RlbCcpXG4gICAgICAgICAgICAgICAgLnNldERlc2MoJ1x1OTAwOVx1NjJFOSBBSSBcdTZBMjFcdTU3OEInKVxuICAgICAgICAgICAgICAgIC5hZGREcm9wZG93bihkcm9wZG93biA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRQcm92aWRlci5tb2RlbHMuZm9yRWFjaChtb2RlbCA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24obW9kZWwuaWQsIG1vZGVsLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgZHJvcGRvd24uc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubW9kZWwpXG4gICAgICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MubW9kZWwgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQVBJIEtleSBcdThGOTNcdTUxNjVcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnQVBJIEtleScpXG4gICAgICAgICAgICAuc2V0RGVzYygnXHU4RjkzXHU1MTY1IEFQSSBLZXknKVxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdFbnRlciB5b3VyIEFQSSBrZXknKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5hcGlLZXkpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5hcGlLZXkgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIC8vIEFQSSBcdTdBRUZcdTcwQjlcdThGOTNcdTUxNjVcdUZGMDhcdTYyNDBcdTY3MDlcdTYzRDBcdTRGOUJcdTU1NDZcdTkwRkRcdTUzRUZcdTRFRTVcdTgxRUFcdTVCOUFcdTRFNDlcdUZGMDlcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnQVBJIEVuZHBvaW50JylcbiAgICAgICAgICAgIC5zZXREZXNjKCdcdThGOTNcdTUxNjUgQVBJIFx1N0FFRlx1NzBCOVx1NTczMFx1NTc0MFx1RkYwOFx1NTNFRlx1OTAwOVx1RkYwQ1x1NzU1OVx1N0E3QVx1NEY3Rlx1NzUyOFx1OUVEOFx1OEJBNFx1NTAzQ1x1RkYwOScpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBwcm92aWRlciA9IEFJX1BST1ZJREVSUy5maW5kKHAgPT4gcC5pZCA9PT0gdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvdmlkZXIpO1xuICAgICAgICAgICAgICAgIHRleHQuc2V0UGxhY2Vob2xkZXIocHJvdmlkZXI/LmJhc2VVcmwgfHwgJ0VudGVyIEFQSSBlbmRwb2ludCcpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5hcGlFbmRwb2ludClcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gXHU1OTgyXHU2NzlDXHU4RjkzXHU1MTY1XHU0RTNBXHU3QTdBXHVGRjBDXHU0RjdGXHU3NTI4XHU5RUQ4XHU4QkE0XHU3QUVGXHU3MEI5XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwcm92aWRlciA9IEFJX1BST1ZJREVSUy5maW5kKHAgPT4gcC5pZCA9PT0gdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvdmlkZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuYXBpRW5kcG9pbnQgPSB2YWx1ZSB8fCBwcm92aWRlcj8uYmFzZVVybCB8fCAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIC8vIFx1NkRGQlx1NTJBMFx1OTFDRFx1N0Y2RVx1NjMwOVx1OTRBRVxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdcdTkxQ0RcdTdGNkUgQVBJIFx1N0FFRlx1NzBCOScpXG4gICAgICAgICAgICAuc2V0RGVzYygnXHU2MDYyXHU1OTBEXHU5RUQ4XHU4QkE0IEFQSSBcdTdBRUZcdTcwQjknKVxuICAgICAgICAgICAgLmFkZEJ1dHRvbihidXR0b24gPT4gYnV0dG9uXG4gICAgICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoJ1x1OTFDRFx1N0Y2RScpXG4gICAgICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBwcm92aWRlciA9IEFJX1BST1ZJREVSUy5maW5kKHAgPT4gcC5pZCA9PT0gdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvdmlkZXIpO1xuICAgICAgICAgICAgICAgICAgICBpZiAocHJvdmlkZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmFwaUVuZHBvaW50ID0gcHJvdmlkZXIuYmFzZVVybDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5KCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgfVxufSBcbiJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUEsdUJBQWdGOzs7QUNBaEYsc0JBQWtEO0FBRzNDLHlCQUFtQjtBQUFBLEVBT3RCLFlBQ1ksS0FDQSxRQUNBLFFBQ1Y7QUFIVTtBQUNBO0FBQ0E7QUFOSixxQkFBcUI7QUFRekIsU0FBSyxZQUFZLFNBQVMsY0FBYztBQUN4QyxTQUFLLFVBQVUsU0FBUztBQUd4QixTQUFLLFFBQVEsU0FBUyxjQUFjO0FBQ3BDLFNBQUssTUFBTSxTQUFTO0FBQ3BCLFNBQUssTUFBTSxjQUFjO0FBQ3pCLFNBQUssVUFBVSxZQUFZLEtBQUs7QUFHaEMsU0FBSyxXQUFXLFNBQVMsY0FBYztBQUN2QyxTQUFLLFNBQVMsU0FBUztBQUN2QixTQUFLLFVBQVUsWUFBWSxLQUFLO0FBR2hDLFNBQUs7QUFHTCxTQUFLLHNCQUFzQixLQUFLLG1CQUFtQixLQUFLO0FBQUE7QUFBQSxFQUdwRCxxQkFBcUI7QUFDekIsVUFBTSxXQUFXO0FBQUEsTUFDYixFQUFFLElBQUksYUFBYSxNQUFNLDRCQUFRLE1BQU07QUFBQSxNQUN2QyxFQUFFLElBQUksUUFBUSxNQUFNLHdDQUFVLE1BQU07QUFBQSxNQUNwQyxFQUFFLElBQUksU0FBUyxNQUFNLDRCQUFRLE1BQU07QUFBQSxNQUNuQyxFQUFFLElBQUksYUFBYSxNQUFNLGtDQUFTLE1BQU07QUFBQTtBQUc1QyxhQUFTLFFBQVEsU0FBTztBQUNwQixZQUFNLE9BQU8sU0FBUyxjQUFjO0FBQ3BDLFdBQUssU0FBUztBQUVkLFlBQU0sT0FBTyxTQUFTLGNBQWM7QUFDcEMsV0FBSyxTQUFTO0FBQ2QsV0FBSyxTQUFTLElBQUk7QUFFbEIsWUFBTSxPQUFPLFNBQVMsY0FBYztBQUNwQyxXQUFLLGNBQWMsSUFBSTtBQUV2QixXQUFLLFlBQVk7QUFDakIsV0FBSyxZQUFZO0FBRWpCLFdBQUssaUJBQWlCLFNBQVMsTUFBWTtBQUN2QyxjQUFNLFNBQVMsS0FBSyxNQUFNO0FBQzFCLGNBQU0sU0FBUyxNQUFNLEtBQUssZUFBZSxJQUFJLElBQUk7QUFDakQsWUFBSSxRQUFRO0FBQ1IsZUFBSyxPQUFPLGlCQUFpQjtBQUFBO0FBRWpDLGFBQUs7QUFBQTtBQUdULFdBQUssU0FBUyxZQUFZO0FBQUE7QUFBQTtBQUFBLEVBSXBCLGVBQWUsV0FBbUIsUUFBaUM7QUFBQTtBQUM3RSxVQUFJO0FBQ0EsZ0JBQVE7QUFBQSxlQUNDO0FBQ0QsbUJBQU8sTUFBTSxLQUFLLE9BQU8sZ0JBQWdCO0FBQUEsZUFDeEM7QUFDRCxtQkFBTyxNQUFNLEtBQUssT0FBTyxpQkFBaUI7QUFBQSxlQUN6QztBQUNELG1CQUFPLE1BQU0sS0FBSyxPQUFPLGNBQWM7QUFBQSxlQUN0QztBQUNELG1CQUFPLE1BQU0sS0FBSyxPQUFPLGtCQUFrQjtBQUFBO0FBRTNDLG1CQUFPO0FBQUE7QUFBQSxlQUVWLE9BQVA7QUFDRSxZQUFJLHVCQUFPLDJDQUFhLE1BQU07QUFDOUIsZUFBTztBQUFBO0FBQUE7QUFBQTtBQUFBLEVBSVIsaUJBQTBCO0FBQzdCLFdBQU8sU0FBUyxrQkFBa0IsS0FBSztBQUFBO0FBQUEsRUFHM0MsS0FBSyxVQUF5QztBQUMxQyxRQUFJLENBQUMsS0FBSyxXQUFXO0FBRWpCLFlBQU0sZ0JBQWdCLE9BQU87QUFDN0IsWUFBTSxpQkFBaUIsT0FBTztBQUc5QixVQUFJLE9BQU8sU0FBUztBQUNwQixVQUFJLE9BQU8sTUFBTSxlQUFlO0FBQzVCLGVBQU8sZ0JBQWdCO0FBQUE7QUFJM0IsVUFBSSxNQUFNLFNBQVM7QUFDbkIsWUFBTSxrQkFBa0I7QUFDeEIsVUFBSSxNQUFNLGtCQUFrQixnQkFBZ0I7QUFDeEMsY0FBTSxTQUFTLE1BQU0sa0JBQWtCO0FBQUE7QUFHM0MsV0FBSyxVQUFVLE1BQU0sT0FBTyxHQUFHLEtBQUssSUFBSSxJQUFJO0FBQzVDLFdBQUssVUFBVSxNQUFNLE1BQU0sR0FBRyxLQUFLLElBQUksSUFBSTtBQUUzQyxlQUFTLEtBQUssWUFBWSxLQUFLO0FBRy9CLGlCQUFXLE1BQU07QUFDYixhQUFLLE1BQU07QUFBQSxTQUNaO0FBRUgsZUFBUyxpQkFBaUIsYUFBYSxLQUFLO0FBQzVDLFdBQUssWUFBWTtBQUFBO0FBQUE7QUFBQSxFQUl6QixPQUFPO0FBQ0gsUUFBSSxLQUFLLFdBQVc7QUFDaEIsV0FBSyxVQUFVO0FBQ2YsZUFBUyxvQkFBb0IsYUFBYSxLQUFLO0FBQy9DLFdBQUssWUFBWTtBQUNqQixXQUFLLE1BQU0sUUFBUTtBQUFBO0FBQUE7QUFBQSxFQUluQixtQkFBbUIsR0FBZTtBQUN0QyxRQUFJLENBQUMsS0FBSyxVQUFVLFNBQVMsRUFBRSxTQUFpQjtBQUM1QyxXQUFLO0FBQUE7QUFBQTtBQUFBOzs7QUM1SWpCLHVCQUErQztBQXNCeEMsSUFBTSxlQUE2QjtBQUFBLEVBQ3RDO0FBQUEsSUFDSSxJQUFJO0FBQUEsSUFDSixNQUFNO0FBQUEsSUFDTixTQUFTO0FBQUEsSUFDVCxRQUFRO0FBQUEsTUFDSixFQUFFLElBQUksU0FBUyxNQUFNO0FBQUEsTUFDckIsRUFBRSxJQUFJLGVBQWUsTUFBTTtBQUFBLE1BQzNCLEVBQUUsSUFBSSxpQkFBaUIsTUFBTTtBQUFBO0FBQUE7QUFBQSxFQUdyQztBQUFBLElBQ0ksSUFBSTtBQUFBLElBQ0osTUFBTTtBQUFBLElBQ04sU0FBUztBQUFBLElBQ1QsUUFBUTtBQUFBLE1BQ0osRUFBRSxJQUFJLGlCQUFpQixNQUFNO0FBQUEsTUFDN0IsRUFBRSxJQUFJLG1CQUFtQixNQUFNO0FBQUEsTUFDL0IsRUFBRSxJQUFJLGNBQWMsTUFBTTtBQUFBO0FBQUE7QUFBQSxFQUdsQztBQUFBLElBQ0ksSUFBSTtBQUFBLElBQ0osTUFBTTtBQUFBLElBQ04sU0FBUztBQUFBLElBQ1QsUUFBUTtBQUFBLE1BQ0osRUFBRSxJQUFJLGtCQUFrQixNQUFNO0FBQUEsTUFDOUIsRUFBRSxJQUFJLG1CQUFtQixNQUFNO0FBQUEsTUFDL0IsRUFBRSxJQUFJLG9CQUFvQixNQUFNO0FBQUE7QUFBQTtBQUFBLEVBR3hDO0FBQUEsSUFDSSxJQUFJO0FBQUEsSUFDSixNQUFNO0FBQUEsSUFDTixTQUFTO0FBQUEsSUFDVCxRQUFRO0FBQUEsTUFDSixFQUFFLElBQUksU0FBUyxNQUFNO0FBQUEsTUFDckIsRUFBRSxJQUFJLGVBQWUsTUFBTTtBQUFBO0FBQUE7QUFBQSxFQUduQztBQUFBLElBQ0ksSUFBSTtBQUFBLElBQ0osTUFBTTtBQUFBLElBQ04sU0FBUztBQUFBLElBQ1QsUUFBUTtBQUFBLE1BQ0osRUFBRSxJQUFJLGlCQUFpQixNQUFNO0FBQUEsTUFDN0IsRUFBRSxJQUFJLGtCQUFrQixNQUFNO0FBQUE7QUFBQTtBQUFBLEVBR3RDO0FBQUEsSUFDSSxJQUFJO0FBQUEsSUFDSixNQUFNO0FBQUEsSUFDTixTQUFTO0FBQUEsSUFDVCxRQUFRO0FBQUEsTUFDSixFQUFFLElBQUksU0FBUyxNQUFNO0FBQUEsTUFDckIsRUFBRSxJQUFJLGdCQUFnQixNQUFNO0FBQUE7QUFBQTtBQUFBLEVBR3BDO0FBQUEsSUFDSSxJQUFJO0FBQUEsSUFDSixNQUFNO0FBQUEsSUFDTixTQUFTO0FBQUEsSUFDVCxRQUFRO0FBQUEsTUFDSixFQUFFLElBQUksa0JBQWtCLE1BQU07QUFBQSxNQUM5QixFQUFFLElBQUksbUJBQW1CLE1BQU07QUFBQSxNQUMvQixFQUFFLElBQUksb0JBQW9CLE1BQU07QUFBQTtBQUFBO0FBQUE7QUFLckMsSUFBTSxtQkFBcUM7QUFBQSxFQUM5QyxVQUFVO0FBQUEsRUFDVixPQUFPO0FBQUEsRUFDUCxRQUFRO0FBQUEsRUFDUixhQUFhO0FBQUE7QUFHVixpQ0FBMkIsa0NBQWlCO0FBQUEsRUFHL0MsWUFBWSxLQUFVLFFBQWtCO0FBQ3BDLFVBQU0sS0FBSztBQUNYLFNBQUssU0FBUztBQUFBO0FBQUEsRUFHbEIsVUFBZ0I7QUFDWixVQUFNLEVBQUUsZ0JBQWdCO0FBQ3hCLGdCQUFZO0FBR1osUUFBSSx5QkFBUSxhQUNQLFFBQVEsZUFDUixRQUFRLGtEQUNSLFlBQVksY0FBWTtBQUNyQixtQkFBYSxRQUFRLGNBQVk7QUFDN0IsaUJBQVMsVUFBVSxTQUFTLElBQUksU0FBUztBQUFBO0FBRTdDLGVBQVMsU0FBUyxLQUFLLE9BQU8sU0FBUyxVQUNsQyxTQUFTLENBQU8sVUFBVTtBQUN2QixhQUFLLE9BQU8sU0FBUyxXQUFXO0FBRWhDLGNBQU0sV0FBVyxhQUFhLEtBQUssT0FBSyxFQUFFLE9BQU87QUFDakQsWUFBSSxVQUFVO0FBRVYsY0FBSSxTQUFTLE9BQU8sU0FBUyxHQUFHO0FBQzVCLGlCQUFLLE9BQU8sU0FBUyxRQUFRLFNBQVMsT0FBTyxHQUFHO0FBQUE7QUFBQTtBQUd4RCxjQUFNLEtBQUssT0FBTztBQUVsQixhQUFLO0FBQUE7QUFBQTtBQUtyQixVQUFNLGtCQUFrQixhQUFhLEtBQUssT0FBSyxFQUFFLE9BQU8sS0FBSyxPQUFPLFNBQVM7QUFDN0UsUUFBSSxpQkFBaUI7QUFDakIsVUFBSSx5QkFBUSxhQUNQLFFBQVEsWUFDUixRQUFRLGdDQUNSLFlBQVksY0FBWTtBQUNyQix3QkFBZ0IsT0FBTyxRQUFRLFdBQVM7QUFDcEMsbUJBQVMsVUFBVSxNQUFNLElBQUksTUFBTTtBQUFBO0FBRXZDLGlCQUFTLFNBQVMsS0FBSyxPQUFPLFNBQVMsT0FDbEMsU0FBUyxDQUFPLFVBQVU7QUFDdkIsZUFBSyxPQUFPLFNBQVMsUUFBUTtBQUM3QixnQkFBTSxLQUFLLE9BQU87QUFBQTtBQUFBO0FBQUE7QUFNdEMsUUFBSSx5QkFBUSxhQUNQLFFBQVEsV0FDUixRQUFRLHdCQUNSLFFBQVEsVUFBUSxLQUNaLGVBQWUsc0JBQ2YsU0FBUyxLQUFLLE9BQU8sU0FBUyxRQUM5QixTQUFTLENBQU8sVUFBVTtBQUN2QixXQUFLLE9BQU8sU0FBUyxTQUFTO0FBQzlCLFlBQU0sS0FBSyxPQUFPO0FBQUE7QUFJOUIsUUFBSSx5QkFBUSxhQUNQLFFBQVEsZ0JBQ1IsUUFBUSxxSEFDUixRQUFRLFVBQVE7QUFDYixZQUFNLFdBQVcsYUFBYSxLQUFLLE9BQUssRUFBRSxPQUFPLEtBQUssT0FBTyxTQUFTO0FBQ3RFLFdBQUssZUFBZSxzQ0FBVSxZQUFXLHNCQUNwQyxTQUFTLEtBQUssT0FBTyxTQUFTLGFBQzlCLFNBQVMsQ0FBTyxVQUFVO0FBRXZCLGNBQU0sWUFBVyxhQUFhLEtBQUssT0FBSyxFQUFFLE9BQU8sS0FBSyxPQUFPLFNBQVM7QUFDdEUsYUFBSyxPQUFPLFNBQVMsY0FBYyxTQUFTLHdDQUFVLFlBQVc7QUFDakUsY0FBTSxLQUFLLE9BQU87QUFBQTtBQUFBO0FBS2xDLFFBQUkseUJBQVEsYUFDUCxRQUFRLGlDQUNSLFFBQVEsNkNBQ1IsVUFBVSxZQUFVLE9BQ2hCLGNBQWMsZ0JBQ2QsUUFBUSxNQUFZO0FBQ2pCLFlBQU0sV0FBVyxhQUFhLEtBQUssT0FBSyxFQUFFLE9BQU8sS0FBSyxPQUFPLFNBQVM7QUFDdEUsVUFBSSxVQUFVO0FBQ1YsYUFBSyxPQUFPLFNBQVMsY0FBYyxTQUFTO0FBQzVDLGNBQU0sS0FBSyxPQUFPO0FBQ2xCLGFBQUs7QUFBQTtBQUFBO0FBQUE7QUFBQTs7O0FGN0w3Qiw2QkFBc0Msd0JBQU87QUFBQSxFQUE3QyxjQUpBO0FBSUE7QUFFWSx3QkFBb0M7QUFDcEMsNkJBQXlCO0FBQ3pCLDJCQUEwQjtBQUFBO0FBQUEsRUFFNUIsU0FBUztBQUFBO0FBQ1gsWUFBTSxLQUFLO0FBRVgsV0FBSyxjQUFjLElBQUksYUFBYSxLQUFLLEtBQUs7QUFHOUMsV0FBSyxjQUNELEtBQUssSUFBSSxVQUFVLEdBQUcsc0JBQXNCLE1BQU07QUFDOUMsYUFBSztBQUFBO0FBS2IsV0FBSyxjQUNELEtBQUssSUFBSSxVQUFVLEdBQUcsaUJBQWlCLE1BQU07QUFDekMsYUFBSztBQUFBO0FBSWIsVUFBSSxrQkFBa0I7QUFHdEIsV0FBSyxpQkFBaUIsVUFBVSxXQUFXLENBQUMsUUFBdUI7QUFFL0QsWUFBSSxJQUFJLFFBQVEsT0FBTyxDQUFDLElBQUksVUFBVSxDQUFDLElBQUksZUFBZSxDQUFDLGlCQUFpQjtBQUN4RSxnQkFBTSxhQUFhLEtBQUssSUFBSSxVQUFVLG9CQUFvQjtBQUMxRCxjQUFJLFlBQVk7QUFDWixrQkFBTSxTQUFTLFdBQVc7QUFDMUIsa0JBQU0sU0FBUyxPQUFPO0FBQ3RCLGtCQUFNLE9BQU8sT0FBTyxRQUFRLE9BQU87QUFHbkMsZ0JBQUksQ0FBQyxLQUFLLFFBQVE7QUFDZCxrQkFBSTtBQUNKLGdDQUFrQjtBQUNsQixtQkFBSyxhQUFhLFFBQVE7QUFBQTtBQUFBO0FBQUE7QUFNdEMsWUFBSSxJQUFJLFFBQVEsU0FBUztBQUVyQixxQkFBVyxNQUFNO0FBQ2IsaUJBQUs7QUFBQSxhQUNOO0FBQUE7QUFBQTtBQUtYLFdBQUssaUJBQWlCLFVBQVUsU0FBUyxDQUFDLFFBQXVCO0FBQzdELFlBQUksSUFBSSxRQUFRLEtBQUs7QUFDakIsNEJBQWtCO0FBQ2xCLGNBQUksS0FBSyxnQkFBZ0IsQ0FBQyxLQUFLLGFBQWEsa0JBQWtCO0FBQzFELGlCQUFLLGFBQWE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFNNUIsZUFBZTtBQUFBO0FBQ2pCLFdBQUssV0FBVyxPQUFPLE9BQU8sSUFBSSxrQkFBa0IsTUFBTSxLQUFLO0FBQUE7QUFBQTtBQUFBLEVBRzdELGVBQWU7QUFBQTtBQUNqQixZQUFNLEtBQUssU0FBUyxLQUFLO0FBQUE7QUFBQTtBQUFBLEVBR3JCLG9CQUFvQjtBQUN4QixVQUFNLGFBQWEsS0FBSyxJQUFJLFVBQVUsb0JBQW9CO0FBQzFELFFBQUksQ0FBQztBQUFZO0FBRWpCLFVBQU0sU0FBUyxXQUFXO0FBQzFCLFVBQU0sU0FBUyxPQUFPO0FBR3RCLFNBQUs7QUFHTCxVQUFNLGFBQWEsT0FBTztBQUMxQixhQUFTLElBQUksR0FBRyxJQUFJLFlBQVksS0FBSztBQUNqQyxZQUFNLE9BQU8sT0FBTyxRQUFRO0FBQzVCLFVBQUksQ0FBQyxLQUFLLFFBQVE7QUFFZCxZQUFJLE1BQU0sT0FBTyxNQUFNO0FBQ25CLGVBQUssc0JBQXNCLEdBQUc7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBTXRDLHVCQUF1QjtBQUMzQixVQUFNLGFBQWEsS0FBSyxJQUFJLFVBQVUsb0JBQW9CO0FBQzFELFFBQUksQ0FBQztBQUFZO0FBR2pCLFVBQU0sdUJBQXVCLFdBQVcsVUFBVSxpQkFBaUI7QUFDbkUseUJBQXFCLFFBQVEsUUFBTSxHQUFHO0FBR3RDLFFBQUksS0FBSyxtQkFBbUI7QUFDeEIsV0FBSyxrQkFBa0I7QUFDdkIsV0FBSyxvQkFBb0I7QUFBQTtBQUFBO0FBQUEsRUFJekIsc0JBQXNCLFlBQW9CLE1BQW9CO0FBQ2xFLFVBQU0sV0FBVyxLQUFLLFVBQVUsY0FBYztBQUM5QyxRQUFJLENBQUM7QUFBVTtBQUVmLFVBQU0sU0FBUyxTQUFTLGNBQWMsc0JBQXNCLGFBQWE7QUFDekUsUUFBSSxDQUFDO0FBQVE7QUFHYixRQUFJLENBQUMsT0FBTyxjQUFjLDJCQUEyQjtBQUNqRCxZQUFNLGNBQWMsS0FBSztBQUN6QixhQUFPLFlBQVk7QUFHbkIsV0FBSyxvQkFBb0I7QUFBQSxRQUNyQixPQUFPLE1BQU0sWUFBWTtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBSzdCLDJCQUF3QztBQUM1QyxVQUFNLGNBQWMsU0FBUyxjQUFjO0FBQzNDLGdCQUFZLFNBQVM7QUFDckIsZ0JBQVksUUFBUSxLQUFLO0FBRXpCLGdCQUFZLE1BQU0sWUFBWTtBQUM5QixnQkFBWSxNQUFNLFFBQVE7QUFDMUIsV0FBTztBQUFBO0FBQUEsRUFHSCxhQUFhLFFBQWdCLFFBQXdCO0FBQ3pELFVBQU0sT0FBTyxLQUFLLElBQUksVUFBVSxvQkFBb0I7QUFDcEQsUUFBSSxDQUFDO0FBQU07QUFHWCxVQUFNLFdBQVcsS0FBSyxVQUFVLGNBQWM7QUFDOUMsUUFBSSxDQUFDO0FBQVU7QUFFZixVQUFNLFNBQVMsU0FBUyxjQUFjLHNCQUFzQixPQUFPLE9BQU87QUFDMUUsUUFBSSxDQUFDO0FBQVE7QUFHYixVQUFNLGFBQWEsU0FBUztBQUM1QixVQUFNLFdBQVcsT0FBTztBQUV4QixRQUFJLENBQUMsS0FBSyxjQUFjO0FBQ3BCLFdBQUssZUFBZSxJQUFJLGFBQWEsS0FBSyxLQUFLLE1BQU07QUFBQTtBQUl6RCxVQUFNLGVBQWUsU0FBUztBQUM5QixVQUFNLGNBQWMsU0FBUztBQUU3QixTQUFLLGFBQWEsS0FBSztBQUFBLE1BQ25CLE1BQU07QUFBQSxNQUNOLEtBQUssY0FBYyxTQUFTO0FBQUE7QUFBQTtBQUFBLEVBSXBDLFdBQVc7QUFDUCxRQUFJLEtBQUssbUJBQW1CO0FBQ3hCLFdBQUssa0JBQWtCO0FBQUE7QUFFM0IsUUFBSSxLQUFLLGNBQWM7QUFDbkIsV0FBSyxhQUFhO0FBQUE7QUFBQTtBQUFBLEVBSVosVUFBVSxRQUFpQztBQUFBO0FBQ3JELFVBQUk7QUFDQSxjQUFNLFdBQVcsYUFBYSxLQUFLLENBQUMsTUFBa0IsRUFBRSxPQUFPLEtBQUssU0FBUztBQUM3RSxZQUFJLENBQUMsVUFBVTtBQUNYLGdCQUFNLElBQUksTUFBTTtBQUFBO0FBSXBCLGNBQU0sY0FBYyxLQUFLLFNBQVMsZUFBZSxTQUFTO0FBQzFELFlBQUksQ0FBQyxhQUFhO0FBQ2QsZ0JBQU0sSUFBSSxNQUFNO0FBQUE7QUFHcEIsY0FBTSxVQUFrQztBQUFBLFVBQ3BDLGdCQUFnQjtBQUFBO0FBSXBCLGdCQUFRLEtBQUssU0FBUztBQUFBLGVBQ2I7QUFBQSxlQUNBO0FBQ0Qsb0JBQVEsbUJBQW1CLFVBQVUsS0FBSyxTQUFTO0FBQ25EO0FBQUEsZUFDQztBQUNELG9CQUFRLGVBQWUsS0FBSyxTQUFTO0FBQ3JDLG9CQUFRLHVCQUF1QjtBQUMvQjtBQUFBLGVBQ0M7QUFDRCxvQkFBUSxhQUFhLEtBQUssU0FBUztBQUNuQztBQUFBLGVBQ0M7QUFDRCxvQkFBUSxtQkFBbUIsS0FBSyxTQUFTO0FBQ3pDO0FBQUE7QUFFQSxvQkFBUSxtQkFBbUIsVUFBVSxLQUFLLFNBQVM7QUFBQTtBQUkzRCxZQUFJO0FBQ0osZ0JBQVEsS0FBSyxTQUFTO0FBQUEsZUFDYjtBQUNELDBCQUFjO0FBQUEsY0FDVixPQUFPLEtBQUssU0FBUztBQUFBLGNBQ3JCLFVBQVUsQ0FBQyxFQUFFLE1BQU0sUUFBUSxTQUFTO0FBQUEsY0FDcEMsWUFBWTtBQUFBO0FBRWhCO0FBQUE7QUFFQSwwQkFBYztBQUFBLGNBQ1YsT0FBTyxLQUFLLFNBQVM7QUFBQSxjQUNyQixVQUFVLENBQUMsRUFBRSxNQUFNLFFBQVEsU0FBUztBQUFBO0FBQUE7QUFJaEQsY0FBTSxXQUFXLE1BQU0sTUFBTSxhQUFhO0FBQUEsVUFDdEMsUUFBUTtBQUFBLFVBQ1I7QUFBQSxVQUNBLE1BQU0sS0FBSyxVQUFVO0FBQUE7QUFHekIsWUFBSSxDQUFDLFNBQVMsSUFBSTtBQUNkLGdCQUFNLElBQUksTUFBTSx1QkFBdUIsU0FBUztBQUFBO0FBR3BELGNBQU0sT0FBTyxNQUFNLFNBQVM7QUFHNUIsZ0JBQVEsS0FBSyxTQUFTO0FBQUEsZUFDYjtBQUNELG1CQUFPLEtBQUssUUFBUSxHQUFHO0FBQUE7QUFFdkIsbUJBQU8sS0FBSyxRQUFRLEdBQUcsUUFBUTtBQUFBO0FBQUEsZUFFbEMsT0FBUDtBQUNFLFlBQUksd0JBQU8sc0NBQW1CLE1BQWdCO0FBQzlDLGVBQU87QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtGLGdCQUFnQixRQUFpQztBQUFBO0FBQzFELGFBQU8sTUFBTSxLQUFLLFVBQVUsaUNBQVE7QUFBQTtBQUFBO0FBQUEsRUFHM0IsaUJBQWlCLFFBQWlDO0FBQUE7QUFDM0QsYUFBTyxNQUFNLEtBQUssVUFBVSw2Q0FBVTtBQUFBO0FBQUE7QUFBQSxFQUc3QixjQUFjLFFBQWlDO0FBQUE7QUFDeEQsYUFBTyxNQUFNLEtBQUssVUFBVSxpQ0FBUTtBQUFBO0FBQUE7QUFBQSxFQUczQixrQkFBa0IsUUFBaUM7QUFBQTtBQUM1RCxhQUFPLE1BQU0sS0FBSyxVQUFVLHVDQUFTO0FBQUE7QUFBQTtBQUFBOyIsCiAgIm5hbWVzIjogW10KfQo=
